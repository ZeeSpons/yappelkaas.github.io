<!-- exact hetzelfde als jouw versie bovenaan tot aan je script-tag -->
<script>
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");

  let playerImg = new Image();
  playerImg.src = "assets/appelkaas_run.png";
  let appelImg = new Image();
  appelImg.src = "assets/appel.png";
  let kaasImg = new Image();
  kaasImg.src = "assets/kaas.png";
  let gameOverSound = new Audio("assets/gameover.mp3");

  let player = {
    x: 50,
    y: canvas.height - 70,
    width: 50,
    height: 50,
    velocityY: 0,
    grounded: true
  };

  let gravity = 0.4;
  let jumpPower = -12;
  let obstacles = [];
  let score = 0;
  let speed = 3;
  let gameStarted = false;
  let gameOver = false;
  let framesSinceLastObstacle = 0;
  let obstacleCooldown = 100;

  let highscore = parseInt(localStorage.getItem("appelrun_highscore")) || 0;

  function drawPlayer() {
    ctx.drawImage(playerImg, player.x, player.y, player.width, player.height);
  }

  function drawObstacle(ob) {
    const img = ob.type === "appel" ? appelImg : kaasImg;
    ctx.drawImage(img, ob.x, ob.y, ob.width, ob.height);
  }

  function resetGame() {
    if (score > highscore) {
      highscore = score;
      localStorage.setItem("appelrun_highscore", highscore);
    }

    player.y = canvas.height - 70;
    player.velocityY = 0;
    player.grounded = true;
    obstacles = [];
    score = 0;
    speed = 3;
    gameOver = false;
  }

  function update() {
    if (!gameStarted || gameOver) return;

    player.velocityY += gravity;
    player.y += player.velocityY;
    if (player.y >= canvas.height - 70) {
      player.y = canvas.height - 70;
      player.velocityY = 0;
      player.grounded = true;
    } else {
      player.grounded = false;
    }

    for (let i = obstacles.length - 1; i >= 0; i--) {
      obstacles[i].x -= speed;
      if (obstacles[i].x + obstacles[i].width < 0) {
        obstacles.splice(i, 1);
      } else if (
        player.x < obstacles[i].x + obstacles[i].width &&
        player.x + player.width > obstacles[i].x &&
        player.y < obstacles[i].y + obstacles[i].height &&
        player.y + player.height > obstacles[i].y
      ) {
        if (obstacles[i].type === "kaas") {
          gameOver = true;
          gameOverSound.play();
          return;
        } else {
          obstacles.splice(i, 1);
          score++;
          if (score % 5 === 0 && speed < 10) speed += 0.3;
        }
      }
    }

    framesSinceLastObstacle++;
    if (framesSinceLastObstacle >= obstacleCooldown) {
      if (Math.random() < 0.03) {
        let type = Math.random() < 0.6 ? "appel" : "kaas";
        obstacles.push({
          x: canvas.width,
          y: canvas.height - 70,
          width: 40,
          height: 40,
          type: type
        });
        framesSinceLastObstacle = 0;
      }
    }
  }

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawPlayer();
    obstacles.forEach(drawObstacle);

    ctx.fillStyle = "#1e2b3a";
    ctx.font = "20px Segoe UI";
    ctx.fillText("Score: " + score, 10, 30);
    ctx.fillText("Highscore: " + highscore, 10, 55);

    if (!gameStarted) {
      ctx.fillStyle = "#1e2b3a";
      ctx.font = "26px Segoe UI";
      ctx.fillText("Druk op spatie of tik op het scherm!", 300, 200);
    }

    if (gameOver) {
      ctx.fillStyle = "#ff4d4d";
      ctx.font = "28px Segoe UI";
      ctx.fillText("Game Over!", 400, 180);
      ctx.fillStyle = "#1e2b3a";
      ctx.font = "20px Segoe UI";
      ctx.fillText("Druk op spatie of tik om opnieuw te spelen.", 280, 220);
    }
  }

  function gameLoop() {
    update();
    draw();
    requestAnimationFrame(gameLoop);
  }

  function handleJump() {
    if (!gameStarted || gameOver) {
      resetGame();
      gameStarted = true;
    } else if (player.grounded) {
      player.velocityY = jumpPower;
    }
  }

  document.addEventListener("keydown", function (e) {
    if (e.code === "Space") handleJump();
  });

  // âœ… Mobiel & muis ondersteuning
  canvas.addEventListener("click", handleJump);
  canvas.addEventListener("touchstart", function (e) {
    e.preventDefault();
    handleJump();
  });

  gameLoop();
</script>
